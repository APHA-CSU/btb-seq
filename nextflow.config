/* Basic configuration for the Bovine TB pipeline */

manifest {
	author = "Richard Ellis"
	homePage = "https://github.com/ellisrichardj/BovTB-nf"
    description = "This is the updated pipeline for APHA's processing of Mycobacterium bovis WGS data. This has been built to run using nextflow"
    mainScript = "bTB-WGS_process.nf"
}

plugins{
    id 'nf-amazon'
}

profiles {
    local {
    }
    awsbatch {
	process.executor = 'awsbatch'
	process.queue = 'btb-seq_queue_new'
	process.container = 'aaronsfishman/bov-tb:batch'
	aws.region = 'eu-west-1'
	workDir = 's3://nxflow-work/work/'
	region = 'eu-west-1'
    }
}

/* location of reference information: evaluated at runtime */

params.ref = "/home/ubuntu/BovTB-nf/references/Mycbovis-2122-97_LT708304.fas"
params.refgbk = "/home/ubuntu/BovTB-nf/references/Mycbovis-2122-97_LT708304.gb"
params.rptmask = "/home/ubuntu/BovTB-nf/references/Mycbovis-2122-97_LT708304.fas.rpt.regions"
params.allsites = "/home/ubuntu/BovTB-nf/references/All-sites.bed"
params.stage1pat = "/home/ubuntu/BovTB-nf/references/Stage1_patterns/"
params.stage2pat = "/home/ubutnu/BovTB-nf/references/Stage2_patterns/"
params.adapters = "/home/ubuntu/BovTB-nf/references/adapter.fasta"
params.discrimPos = "/home/ubuntu/BovTB-nf/references/DiscrimPos.tsv"

/* map2ref reference index files: staged by nextflow */

params.ref_bwa = "$projectDir/references/Mycbovis-2122-97_LT708304.fas"
params.amb = "$projectDir/references/Mycbovis-2122-97_LT708304.fas.amb"
params.ann = "$projectDir/references/Mycbovis-2122-97_LT708304.fas.ann"
params.bwt = "$projectDir/references/Mycbovis-2122-97_LT708304.fas.bwt"
params.pac = "$projectDir/references/Mycbovis-2122-97_LT708304.fas.pac"
params.sa = "$projectDir/references/Mycbovis-2122-97_LT708304.fas.sa"

/* location of python scripts */

params.pypath = "$projectDir/pyscripts/"

/* quality thresholds */
env.min_mean_cov = 8
env.min_cov_snp = 5 
env.alt_prop_snp = 0.2 
env.min_qual_snp = 150
env.min_qual_nonsnp = 0

/* quality thresholds (snp filtering) */
params.MIN_READ_DEPTH = 8
params.MIN_ALLELE_FREQUENCY_ALT = 0.8
params.MIN_ALLELE_FREQUENCY_REF = 0.5

/* location of dependancies */

params.kraken2db = "/home/ubuntu/BovTB-nf/biotools/Kraken2/db/minikraken2_v1_8GB/"
