nextflow_workflow {

  name "Test Workflow main.nf"
  script "main.nf"
  workflow "btb_seq"

  test("Test integration (especially combining multiple samples)") {

    when {
      params {
        reads = "${projectDir}/tests/data/phix_test/combine_tests/*{R1,R2}*.fastq.gz"
        outdir = "${projectDir}/.nf-test/out"
        dataDir = "combine_tests"     
        today  = "15Aug25"
        user   = "UnknownUser"
      }
    }

    then {
            assert workflow.success

            with(workflow.out.combineoutput_ch) {
                assert size() >= 1
                assert path(get(0)).md5 == "21adc8b3b449b47704a5c7333709bf29"
            }
    }
  }
}